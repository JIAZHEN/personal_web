- provide(:title, "Blog")

%section.profile.jumbotron
  .container
    .row
      .col-md-6.col-md-offset-3
        %header
          %img.img-circle.pull-right{:src => image_path("profile.jpg"), :width => "120", :height => "120"}
          %h1
            %a.link.link-darker Jiazhen Xie
          %p.hero-description.description-color
            Software Engineer. Tech Enthusiasm. Traveler. Rubyist.
            %a.link.description-color{:href => "https://twitter.com/JIAZHENXIE"}
              @JiazhenXie

        %div
          %a.link.description-color{:href => "https://twitter.com/JIAZHENXIE/following"}
            %b 123
            Following
          %a.link.description-color{:href => "https://twitter.com/JIAZHENXIE/followers"}
            %b 123
            Followers
          %a.link.description-color.media-set{:alt => "jiazhenjoe"}
            %i.fa.fa-weixin
          %a.link.description-color.media-set{:href => "https://twitter.com/JIAZHENXIE"}
            %i.fa.fa-twitter
          %a.link.description-color.media-set{:href => "#"}
            %i.fa.fa-weibo

%section
  .container
    .row
      .col-md-6.col-md-offset-3
        %h3
          %b Latest
        %hr

        .grid
          - @posts.each do |post|
            .post-item
              .post-avatar
                %img.img-circle{:src => image_path("profile.jpg"), :width => "36", :height => "36"}

              .post-summary
                %a.link.link-accent Jiazhen Xie
                in
                %a.link.link-accent UK
                %span.post-meta.dim-text
                  = time_ago_in_words(post.created_at)
                  ago
                  %span.middotDivider
                  Read

              .post-content
                %h3
                  %a.link.link-darker
                    %b= post.title
                %h4
                  %a.link.link-dark= post.subtitle

              .post-footer
                %a.link.dim-text Read more...
              %hr
    .row
      .col-lg-12
        = paginate @posts


:javascript
  $(document).ready(function(){

    var $container = $('.grid');
    $container.imagesLoaded(function(){
      $container.masonry({
        itemSelector: '.post-item'
      });
    });

    $container.infinitescroll({
      navSelector  : '.pagination',    // selector for the paged navigation
      nextSelector : '.pagination .next a',  // selector for the NEXT link (to page 2)
      itemSelector : '.post-item',     // selector for all items you'll retrieve
      loading: {
          finishedMsg: 'No more pages to load.'
        }
      },
      // trigger Masonry as a callback
      function( newElements ) {
        // hide new items while they are loading
        var $newElems = $( newElements ).css({ opacity: 0 });
        // ensure that images load before adding to masonry layout
        $newElems.imagesLoaded(function(){
          // show elems now they're ready
          $newElems.animate({ opacity: 1 });
          $container.masonry( 'appended', $newElems, true );
        });
      }
    );

  });
